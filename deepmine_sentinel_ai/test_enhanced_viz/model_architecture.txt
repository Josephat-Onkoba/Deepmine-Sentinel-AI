Model: "EnhancedDualBranchStabilityPredictor_v2"
┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ static_input        │ (None, 20)        │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ timeseries_input    │ (None, 30, 5)     │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ static_dense_1      │ (None, 128)       │      2,688 │ static_input[0][… │
│ (Dense)             │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ lstm_1 (LSTM)       │ (None, 30, 128)   │     68,608 │ timeseries_input… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ static_bn_1         │ (None, 128)       │        512 │ static_dense_1[0… │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ lstm_bn_1           │ (None, 30, 128)   │        512 │ lstm_1[0][0]      │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ static_dropout_1    │ (None, 128)       │          0 │ static_bn_1[0][0] │
│ (Dropout)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ lstm_2 (LSTM)       │ (None, 30, 128)   │    131,584 │ lstm_bn_1[0][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ static_dense_2      │ (None, 128)       │     16,512 │ static_dropout_1… │
│ (Dense)             │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ lstm_bn_2           │ (None, 30, 128)   │        512 │ lstm_2[0][0]      │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ static_bn_2         │ (None, 128)       │        512 │ static_dense_2[0… │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ lstm_residual (Add) │ (None, 30, 128)   │          0 │ lstm_bn_1[0][0],  │
│                     │                   │            │ lstm_bn_2[0][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ static_dropout_2    │ (None, 128)       │          0 │ static_bn_2[0][0] │
│ (Dropout)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ temporal_attention  │ (None, 30, 128)   │     66,048 │ lstm_residual[0]… │
│ (MultiHeadAttentio… │                   │            │ lstm_residual[0]… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ static_residual     │ (None, 128)       │          0 │ static_dropout_1… │
│ (Add)               │                   │            │ static_dropout_2… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ attention_residual  │ (None, 30, 128)   │          0 │ lstm_residual[0]… │
│ (Add)               │                   │            │ temporal_attenti… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ static_dense_3      │ (None, 64)        │      8,256 │ static_residual[… │
│ (Dense)             │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ attention_norm      │ (None, 30, 128)   │        256 │ attention_residu… │
│ (LayerNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ static_bn_3         │ (None, 64)        │        256 │ static_dense_3[0… │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ lstm_final (LSTM)   │ (None, 64)        │     49,408 │ attention_norm[0… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ static_dropout_3    │ (None, 64)        │          0 │ static_bn_3[0][0] │
│ (Dropout)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ lstm_bn_final       │ (None, 64)        │        256 │ lstm_final[0][0]  │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ lstm_dropout_final  │ (None, 64)        │          0 │ lstm_bn_final[0]… │
│ (Dropout)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ repeat_vector       │ (None, 1, 64)     │          0 │ static_dropout_3… │
│ (RepeatVector)      │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ reshape (Reshape)   │ (None, 1, 64)     │          0 │ repeat_vector[0]… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ reshape_1 (Reshape) │ (None, 1, 64)     │          0 │ lstm_dropout_fin… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ cross_modal_attent… │ (None, 1, 64)     │     16,640 │ reshape[0][0],    │
│ (MultiHeadAttentio… │                   │            │ reshape_1[0][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ cross_attention_fl… │ (None, 64)        │          0 │ cross_modal_atte… │
│ (Flatten)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ feature_fusion      │ (None, 192)       │          0 │ static_dropout_3… │
│ (Concatenate)       │                   │            │ lstm_dropout_fin… │
│                     │                   │            │ cross_attention_… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ shared_dense_1      │ (None, 128)       │     24,704 │ feature_fusion[0… │
│ (Dense)             │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ shared_bn_1         │ (None, 128)       │        512 │ shared_dense_1[0… │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ shared_dropout_1    │ (None, 128)       │          0 │ shared_bn_1[0][0] │
│ (Dropout)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ shared_dense_2      │ (None, 64)        │      8,256 │ shared_dropout_1… │
│ (Dense)             │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ shared_bn_2         │ (None, 64)        │        256 │ shared_dense_2[0… │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ shared_dropout_2    │ (None, 64)        │          0 │ shared_bn_2[0][0] │
│ (Dropout)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_1d_dense_1   │ (None, 32)        │      2,080 │ shared_dropout_2… │
│ (Dense)             │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_3d_dense_1   │ (None, 32)        │      2,080 │ shared_dropout_2… │
│ (Dense)             │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_7d_dense_1   │ (None, 32)        │      2,080 │ shared_dropout_2… │
│ (Dense)             │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_14d_dense_1  │ (None, 32)        │      2,080 │ shared_dropout_2… │
│ (Dense)             │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_30d_dense_1  │ (None, 32)        │      2,080 │ shared_dropout_2… │
│ (Dense)             │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_1d_bn_1      │ (None, 32)        │        128 │ future_1d_dense_… │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_3d_bn_1      │ (None, 32)        │        128 │ future_3d_dense_… │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_7d_bn_1      │ (None, 32)        │        128 │ future_7d_dense_… │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_14d_bn_1     │ (None, 32)        │        128 │ future_14d_dense… │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_30d_bn_1     │ (None, 32)        │        128 │ future_30d_dense… │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_1d_dropout_1 │ (None, 32)        │          0 │ future_1d_bn_1[0… │
│ (Dropout)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_3d_dropout_1 │ (None, 32)        │          0 │ future_3d_bn_1[0… │
│ (Dropout)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_7d_dropout_1 │ (None, 32)        │          0 │ future_7d_bn_1[0… │
│ (Dropout)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_14d_dropout… │ (None, 32)        │          0 │ future_14d_bn_1[… │
│ (Dropout)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_30d_dropout… │ (None, 32)        │          0 │ future_30d_bn_1[… │
│ (Dropout)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ current_dense       │ (None, 32)        │      2,080 │ shared_dropout_2… │
│ (Dense)             │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_1d_dense_2   │ (None, 32)        │      1,056 │ future_1d_dropou… │
│ (Dense)             │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_3d_dense_2   │ (None, 32)        │      1,056 │ future_3d_dropou… │
│ (Dense)             │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_7d_dense_2   │ (None, 33)        │      1,089 │ future_7d_dropou… │
│ (Dense)             │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_14d_dense_2  │ (None, 34)        │      1,122 │ future_14d_dropo… │
│ (Dense)             │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_30d_dense_2  │ (None, 36)        │      1,188 │ future_30d_dropo… │
│ (Dense)             │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ current_bn          │ (None, 32)        │        128 │ current_dense[0]… │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_1d_bn_2      │ (None, 32)        │        128 │ future_1d_dense_… │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_3d_bn_2      │ (None, 32)        │        128 │ future_3d_dense_… │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_7d_bn_2      │ (None, 33)        │        132 │ future_7d_dense_… │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_14d_bn_2     │ (None, 34)        │        136 │ future_14d_dense… │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_30d_bn_2     │ (None, 36)        │        144 │ future_30d_dense… │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ current_dropout     │ (None, 32)        │          0 │ current_bn[0][0]  │
│ (Dropout)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_1d_dropout_2 │ (None, 32)        │          0 │ future_1d_bn_2[0… │
│ (Dropout)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_3d_dropout_2 │ (None, 32)        │          0 │ future_3d_bn_2[0… │
│ (Dropout)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_7d_dropout_2 │ (None, 33)        │          0 │ future_7d_bn_2[0… │
│ (Dropout)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_14d_dropout… │ (None, 34)        │          0 │ future_14d_bn_2[… │
│ (Dropout)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_30d_dropout… │ (None, 36)        │          0 │ future_30d_bn_2[… │
│ (Dropout)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ current_stability   │ (None, 1)         │         33 │ current_dropout[… │
│ (Dense)             │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_risk_1d      │ (None, 6)         │        198 │ future_1d_dropou… │
│ (Dense)             │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_risk_3d      │ (None, 6)         │        198 │ future_3d_dropou… │
│ (Dense)             │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_risk_7d      │ (None, 6)         │        204 │ future_7d_dropou… │
│ (Dense)             │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_risk_14d     │ (None, 6)         │        210 │ future_14d_dropo… │
│ (Dense)             │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ future_risk_30d     │ (None, 6)         │        222 │ future_30d_dropo… │
│ (Dense)             │                   │            │                   │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
 Total params: 1,245,578 (4.75 MB)
 Trainable params: 414,398 (1.58 MB)
 Non-trainable params: 2,382 (9.30 KB)
 Optimizer params: 828,798 (3.16 MB)
\n